language: node_js

node_js: 10

env:
  global:
    - SEQ_DB=sequelizr_test
    - SEQ_USER=sequelizr_test
    - SEQ_PW=sequelizr_test
    - SEQ_HOST=localhost
    - SEQ_PORT=8980
    - MYSQLDB_ENTRYPOINT=$TRAVIS_BUILD_DIR/scripts/mysql
    - DIALECT=mysql

jobs:
  include:
    - stage: test ğŸ‘©ğŸ½â€ğŸ’»
      sudo: required
      before_script:
        - docker-compose up -d mysql-80;
        - docker run --link mysql-80:db -e CHECK_PORT=3306 -e CHECK_HOST=db --net sequelizr_default giorgos/takis;
      script: npm run test

    - stage: lint âœ¨
      script: npm run lint

    - stage: release ğŸ‰
      if: branch = master AND type = push AND fork = false
      script: npm run semantic-release

cache: npm

sudo: true

git:
  depth: 3
